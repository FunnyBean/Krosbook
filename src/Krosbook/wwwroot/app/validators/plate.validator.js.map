{"version":3,"sources":["app/validators/plate.validator.ts"],"names":[],"mappings":";;;;;;;;;;AAAA,qBAA4C,eAAe,CAAC,CAAA;AAC5D,sBAAyC,gBAAgB,CAAC,CAAA;AAC1D,4BAAyB,yBAAyB,CAAC,CAAA;AASnD;IAKE,kCAAoB,UAAqB;QAL3C,iBAmCC;QA9BqB,eAAU,GAAV,UAAU,CAAW;QAFjC,kBAAa,GAAG,IAAI,CAAC;QAG3B,IAAI,CAAC,UAAU,CAAC,OAAO,EAAE,CAAC,SAAS,CACjC,UAAA,IAAI,IAAK,KAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,EAAE,CAAA,CAAA,CAAC,EACjC,UAAA,KAAK,IAAI,OAAA,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,EAAlB,CAAkB,CAC5B,CAAC;IACJ,CAAC;IAED,2CAAQ,GAAR,UAAS,CAAa;QACpB,IAAI,KAAY,CAAC;QACjB,EAAE,CAAA,CAAC,CAAC,CAAC,KAAK,IAAI,IAAI,CAAC;YACjB,KAAK,GAAG,CAAC,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC;QAEhC,oHAAoH;QACpH,EAAE,CAAA,CAAC,IAAI,CAAC,aAAa,IAAI,IAAI,IAAI,KAAK,IAAI,IAAI,CAAC;YAC7C,IAAI,CAAC,aAAa,GAAG,KAAK,CAAC;QAC7B,EAAE,CAAA,CAAC,KAAK,IAAI,IAAI,CAAC;YACf,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;QAE5B,EAAE,CAAA,CAAC,IAAI,CAAC,aAAa,IAAI,KAAK,CAAC;YAC7B,MAAM,CAAC,IAAI,CAAC;QACd,EAAE,CAAA,CAAC,IAAI,CAAC,IAAI,CAAC,CACb,CAAC;YACC,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;gBAC1C,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,IAAI,KAAK,CAAC;oBAC9B,MAAM,CAAC,EAAC,uBAAuB,EAAE,IAAI,EAAC,CAAA;YAC1C,CAAC;QACH,CAAC;QACD,MAAM,CAAC,IAAI,CAAC;IACd,CAAC;IAxCH;QAAC,gBAAS,CAAC;YACT,QAAQ,EAAE,2EAA2E;YACrF,SAAS,EAAE;gBACT,EAAE,OAAO,EAAE,qBAAa,EAAE,WAAW,EAAE,iBAAU,CAAC,cAAM,OAAA,wBAAwB,EAAxB,CAAwB,CAAC,EAAE,KAAK,EAAE,IAAI,EAAE,EAAE,wBAAU;aAC7G;SACF,CAAC;;gCAAA;IAqCF,+BAAC;AAAD,CAnCA,AAmCC,IAAA;AAnCY,gCAAwB,2BAmCpC,CAAA;AASD;IAAA;IAWA,CAAC;IATC,iCAAQ,GAAR,UAAS,CAAa;QACpB,IAAI,KAAY,CAAC;QACjB,EAAE,CAAA,CAAC,CAAC,CAAC,KAAK,IAAI,IAAI,CAAC;YACjB,KAAK,GAAG,CAAC,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC;QAChC,EAAE,CAAA,CAAC,4BAA4B,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YAC1C,MAAM,CAAC,IAAI,CAAC;QACd,IAAI;YAAC,MAAM,CAAC,EAAC,aAAa,EAAE,IAAI,EAAC,CAAA;IAEnC,CAAC;IAjBH;QAAC,gBAAS,CAAC;YACT,QAAQ,EAAE,uDAAuD;YACjE,SAAS,EAAE;gBACT,EAAE,OAAO,EAAE,qBAAa,EAAE,WAAW,EAAE,iBAAU,CAAC,cAAM,OAAA,cAAc,EAAd,CAAc,CAAC,EAAE,KAAK,EAAE,IAAI,EAAE,EAAE,wBAAU;aACnG;SACF,CAAC;;sBAAA;IAaF,qBAAC;AAAD,CAXA,AAWC,IAAA;AAXY,sBAAc,iBAW1B,CAAA","file":"app/validators/plate.validator.js","sourcesContent":["import {Directive, forwardRef, OnInit} from '@angular/core';\r\nimport {NG_VALIDATORS, FormControl} from '@angular/forms';\r\nimport {CarService} from '../services/car.service';\r\n\r\n@Directive({\r\n  selector: '[validatePlateUniqueness][ngModel],[validatePlateUniqueness][formControl]',\r\n  providers: [\r\n    { provide: NG_VALIDATORS, useExisting: forwardRef(() => PlateUniquenessValidator), multi: true }, CarService\r\n  ]\r\n})\r\n\r\nexport class PlateUniquenessValidator{\r\n\r\n  private cars;\r\n  private initialCValue = null;\r\n\r\n  constructor(private carService:CarService) {\r\n    this.carService.getCars().subscribe(\r\n      data => {this.cars = data.json()},\r\n      error => console.log(error)\r\n    );\r\n  }\r\n\r\n  validate(c:FormControl){\r\n    var plate:string;\r\n    if(c.value != null)\r\n      plate = c.value.toUpperCase();\r\n\r\n    //nastavenia pre správne fungovanie editovania - nahratie prvej hodnoty do premennej - ak je nová miestnosť tak NULL\r\n    if(this.initialCValue == null && plate != null)\r\n      this.initialCValue = plate;\r\n    if(plate == null)\r\n      this.initialCValue = null;\r\n\r\n    if(this.initialCValue == plate)\r\n      return null;\r\n    if(this.cars)\r\n    {\r\n      for (var i = 0; i < this.cars.length; i++) {\r\n        if (this.cars[i].plate == plate)\r\n          return {validatePlateUniqueness: true}\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n}\r\n\r\n@Directive({\r\n  selector: '[validatePlate][ngModel],[validatePlate][formControl]',\r\n  providers: [\r\n    { provide: NG_VALIDATORS, useExisting: forwardRef(() => PlateValidator), multi: true }, CarService\r\n  ]\r\n})\r\n\r\nexport class PlateValidator{\r\n\r\n  validate(c:FormControl){\r\n    var plate:string;\r\n    if(c.value != null)\r\n      plate = c.value.toUpperCase();\r\n    if(/^[A-Z]{2}?-?\\d{3}[A-Z]{2}$/.test(plate))\r\n      return null;\r\n    else return {validatePlate: true}\r\n\r\n  }\r\n}\r\n"],"sourceRoot":"/source/"}
{"version":3,"sources":["app/components/admin/users/detail/detail.user.admin.component.ts"],"names":[],"mappings":"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","file":"app/components/admin/users/detail/detail.user.admin.component.js","sourcesContent":["/**\r\n * Created by Tibor Poštek on 18.07.2016.\r\n */\r\nimport {Component, OnInit, Input, Output, EventEmitter} from  '@angular/core';\r\nimport {UserService} from '../../../../services/user.service';\r\nimport {User} from \"../../../../models/user.admin.model\";\r\nimport {EmailValidator} from '../../../../validators/email.validator';\r\nimport {Role} from \"../../../../models/role.admin.model\";\r\nimport {EmailNameValidator} from '../../../../validators/emailName.validator';\r\n\r\n@Component({\r\n  selector: 'user',\r\n  templateUrl: 'app/components/admin/users/detail/detail.user.admin.component.html',\r\n  styleUrls: ['lib/css/modalWindow.css'],\r\n  directives: [EmailValidator,EmailNameValidator]\r\n})\r\n\r\nexport class DetailUserAdminComponent implements OnInit {\r\n  public error:string;\r\n  public success:string;\r\n  public saving:boolean = false;\r\n  public formReset:boolean = true;\r\n  public allRoles:Array<Role>;\r\n  public checkedRoles:Array<boolean> = new Array();\r\n  public userData:User = new User();\r\n\r\n  @Input() userId:number;\r\n  @Output() windowClose = new EventEmitter<boolean>();\r\n  @Output() updateList = new EventEmitter<boolean>();\r\n\r\n  constructor(private userService:UserService) { }\r\n\r\n\r\n  ngOnInit() {\r\n    if (this.userId) {\r\n      this.getData();\r\n    } else {\r\n      this.getRoles();\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    this.userService.getUser(this.userId).subscribe(\r\n      data => {\r\n        this.userData = data.json()\r\n      },\r\n      error => console.error(error),\r\n      () => this.getRoles());\r\n  }\r\n\r\n\r\n  newUser() {\r\n    this.saving = true;\r\n    let email = this.userData.email;\r\n    let name = this.userData.name;\r\n    let surname = this.userData.surname;\r\n    let roles = JSON.parse(\"[]\");\r\n    for (var i = 0; i < this.allRoles.length; i++) {\r\n      if (this.checkedRoles[i]) {\r\n        roles.push({\"roleId\": this.allRoles[i].id});\r\n      }\r\n    }\r\n    this.userService.addUser(JSON.stringify({email, name, surname, roles})).subscribe(\r\n      data => { },\r\n      error => { this.error = error; this.saving = false; },\r\n      () => {\r\n        this.saving = false;\r\n        this.success = 'Užívateľ úspešne vytvorený.';\r\n        this.userData = new User();\r\n        this.formReset = false;\r\n        setTimeout(() => this.formReset = true, 0);\r\n        for (var i = 0; i < this.allRoles.length; i++)\r\n          this.checkedRoles[i] = false;\r\n        this.updateList.emit(true);\r\n      }\r\n    );\r\n  }\r\n\r\n  editUser() {\r\n    this.saving = true;\r\n    let id = this.userData.id;\r\n    let email = this.userData.email;\r\n    let name = this.userData.name;\r\n    let surname = this.userData.surname;\r\n    let PhotoBase64 = this.userData.photoBase64;\r\n    let roles = JSON.parse(\"[]\");\r\n    for (var i = 0; i < this.allRoles.length; i++) {\r\n      if (this.checkedRoles[i]) {\r\n        roles.push({\"roleId\": this.allRoles[i].id});\r\n      }\r\n    }\r\n    this.userService.editUser(id, JSON.stringify({id, email, name, surname, roles, PhotoBase64})).subscribe(\r\n      data => {\r\n      },\r\n      error => {\r\n        this.error = error;\r\n        this.saving = false;\r\n      },\r\n      () => {\r\n        this.saving = false;\r\n        this.success = 'Užívateľ úspešne upravený.';\r\n        this.updateList.emit(true);\r\n      }\r\n    );\r\n\r\n  }\r\n\r\n  getRoles() {\r\n    this.userService.getRoles().subscribe(\r\n      data => {\r\n        this.allRoles = data.json()\r\n      },\r\n      error => console.log(error),\r\n      () => this.setUserRoles()\r\n    );\r\n  }\r\n\r\n  setUserRoles() {\r\n    if(this.userId) {\r\n      for (var i = 0; i < this.allRoles.length; i++) {\r\n        this.checkedRoles[i] = false;\r\n        for (var j = 0; j < this.userData.roles.length; j++) {\r\n          if (this.allRoles[i].id == this.userData.roles[j].roleId) {\r\n            this.checkedRoles[i] = true;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  closeWindow() {\r\n    this.windowClose.emit(false);\r\n  }\r\n}\r\n"],"sourceRoot":"/source/"}
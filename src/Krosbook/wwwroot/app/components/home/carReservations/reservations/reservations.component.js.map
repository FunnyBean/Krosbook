{"version":3,"sources":["app/components/home/carReservations/reservations/reservations.component.ts"],"names":[],"mappings":";;;;;;;;;;AAAA,qBAAwE,eAAe,CAAC,CAAA;AACxF,uBAAgD,iBAAiB,CAAC,CAAA;AAClE,4BAAyB,kCAAkC,CAAC,CAAA;AAE5D,6BAA0B,mCAAmC,CAAC,CAAA;AAE9D,iCAAmB,qCAAqC,CAAC,CAAA;AACzD,6CAAwC,sCAAsC,CAAC,CAAA;AAC/E,IAAY,MAAM,WAAM,QAAQ,CAAC,CAAA;AACjC,+BAA2C,uCAAuC,CAAC,CAAA;AACnF,uCAAmC,iCAAiC,CAAC,CAAA;AAWrE;IAoBI,+BAAoB,KAAqB,EAAU,UAAsB,EAAU,WAAwB;QAAvF,UAAK,GAAL,KAAK,CAAgB;QAAU,eAAU,GAAV,UAAU,CAAY;QAAU,gBAAW,GAAX,WAAW,CAAa;QAnBpG,oBAAe,GAAW,MAAM,CAAC;QACjC,UAAK,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QACzB,eAAU,GAAS,IAAI,uBAAI,EAAE,CAAC;QAE9B,cAAS,GAAG,EAAE,CAAC;QACf,WAAM,GAAG,CAAC,CAAC;QACX,YAAO,GAAW,IAAI,CAAC;QAEvB,SAAI,GAAW,CAAC,CAAC;QAGjB,QAAG,GAAG,MAAM,EAAE,CAAC;QACf,aAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;QAEzC,oBAAe,GAAY,KAAK,CAAC;QACjC,SAAI,GAAkB,IAAI,KAAK,EAAU,CAAC;IAI8D,CAAC;IAEhH,wCAAQ,GAAR;QACI,IAAI,CAAC,aAAa,EAAE,CAAC;QACrB,IAAI,CAAC,UAAU,EAAE,CAAC;QAClB,IAAI,CAAC,UAAU,EAAE,CAAC;QAElB,CAAC,CAAC,WAAW,CAAC,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;QACrC,CAAC,CAAC,SAAS,CAAC,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;IAGpC,CAAC;IAED,2CAAW,GAAX;QACI,CAAC,CAAC,UAAU,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;IACnC,CAAC;IAED,+CAAe,GAAf;QACI,IAAI,MAAM,GAAG,IAAI,CAAC,yBAAyB,CAAC,OAAO,EAAE,CAAC;QACtD,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;YACrC,MAAM,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACpC,CAAC;IACL,CAAC;IAED,kDAAkB,GAAlB;QACI,IAAI,CAAC,UAAU,GAAG,QAAQ,CAAC,cAAc,CAAC,kBAAkB,CAAC,CAAC,WAAW,CAAC;QAE1E,CAAC,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,QAAQ,EAAE;YACnB,IAAI,CAAC,UAAU,GAAG,QAAQ,CAAC,cAAc,CAAC,kBAAkB,CAAC,CAAC,WAAW,CAAC;YAC1E,CAAC,CAAC,eAAe,CAAC,CAAC,GAAG,CAAC,EAAE,OAAO,EAAE,IAAI,CAAC,UAAU,EAAE,CAAC,CAAC;QACzD,CAAC,CAAC,CAAC;QAEH,CAAC,CAAC,UAAU,CAAC,CAAC,MAAM,CAAC;YACjB,IAAI,OAAO,GAAG,CAAC,CAAC,OAAO,CAAC,CAAC;YACzB,IAAI,UAAU,GAAG,QAAQ,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC,YAAY,CAAC;YAChE,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,WAAW,CAAC,IAAI,OAAO,CAAC,MAAM,EAAE,CAAC,GAAG,IAAI,UAAU,CAAC,CAAC,CAAC;gBACvE,OAAO,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,GAAG,CAAC,EAAE,KAAK,EAAE,UAAU,EAAE,CAAC,CAAC;gBACzD,CAAC,CAAC,gBAAgB,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,QAAQ,EAAE,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;YACpE,CAAC;YACD,EAAE,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,UAAU,CAAC,CAAC,MAAM,EAAE,CAAC,GAAG,GAAG,OAAO,CAAC,MAAM,EAAE,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC;gBACxG,OAAO,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;gBACjC,CAAC,CAAC,gBAAgB,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC,CAAC;YACzD,CAAC;QACL,CAAC,CAAC,CAAC;IACP,CAAC;IAED,6CAAa,GAAb;QACI,IAAI,CAAC,OAAO,GAAG,CAAC,EAAE,GAAG,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC;IAC5D,CAAC;IAED,6CAAa,GAAb;QAAA,iBAgBC;QAfG,IAAI,CAAC,WAAW,CAAC,QAAQ,EAAE,CAAC,SAAS,CACjC,UAAA,IAAI;YACA,IAAI,UAAU,GAAG,IAAI,CAAC,IAAI,EAAE,CAAC;YAC7B,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE;gBACtC,KAAI,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,GAAG,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC;QAC5F,CAAC,EACD,UAAA,KAAK,IAAI,OAAA,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,EAAlB,CAAkB,EAC3B,cAAQ,KAAI,CAAC,YAAY,EAAE,CAAA,CAAC,CAAC,CAChC,CAAC;QACF,IAAI,CAAC,WAAW,CAAC,SAAS,EAAE,CAAC,SAAS,CAClC,UAAA,IAAI;YACA,KAAI,CAAC,UAAU,GAAG,IAAI,CAAC,IAAI,EAAE,CAAC;QAClC,CAAC,EACD,UAAA,KAAK,IAAI,OAAA,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,EAAlB,CAAkB,CAC9B,CAAC;IACN,CAAC;IAGD,4CAAY,GAAZ;QAAA,iBAYC;QAXG,IAAI,CAAC,UAAU,CAAC,OAAO,EAAE,CAAC,SAAS,CAC/B,UAAA,IAAI;YACA,KAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,EAAE,CAAC;YACxB,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;gBACxC,IAAI,GAAG,GAAG,KAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;gBACvB,EAAE,CAAC,CAAC,KAAI,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;oBAClC,KAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;YACjC,CAAC;QACL,CAAC,EACD,UAAA,KAAK,IAAI,OAAA,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,EAAlB,CAAkB,CAC9B,CAAC;IACN,CAAC;IAED,0CAAU,GAAV;QACI,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,EAAE,EAAE,CAAC;YAC1B,IAAI,IAAI,GAAG,MAAM,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;YACtD,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC,CAAC;QACtC,CAAC;IACL,CAAC;IAED,uCAAO,GAAP;QACI,IAAI,CAAC,IAAI,IAAI,CAAC,CAAC;QACf,IAAI,CAAC,UAAU,EAAE,CAAC;QAClB,IAAI,CAAC,eAAe,EAAE,CAAC;IAC3B,CAAC;IAED,wCAAQ,GAAR;QACI,IAAI,CAAC,IAAI,IAAI,CAAC,CAAC;QACf,IAAI,CAAC,UAAU,EAAE,CAAC;QAClB,IAAI,CAAC,eAAe,EAAE,CAAC;IAC3B,CAAC;IAED,yCAAS,GAAT;QACI,IAAI,CAAC,IAAI,GAAG,CAAC,CAAC;QACd,IAAI,CAAC,UAAU,EAAE,CAAC;QAClB,IAAI,CAAC,eAAe,EAAE,CAAC;IAC3B,CAAC;IAED,0CAAU,GAAV;QACI,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,IAAI,EAAE,GAAG,MAAM,EAAE,CAAC,IAAI,EAAE,GAAG,EAAE,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,IAAI,EAAE,GAAG,MAAM,EAAE,CAAC,IAAI,EAAE,CAAC,CAAC;QACnH,EAAE,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,IAAI,EAAE,GAAG,MAAM,EAAE,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;YAAC,IAAI,CAAC,IAAI,EAAE,CAAC;QACtE,IAAI,CAAC,UAAU,EAAE,CAAC;QAClB,IAAI,CAAC,eAAe,EAAE,CAAC;IAC3B,CAAC;IAED,0CAAU,GAAV;QACI,IAAI,CAAC,KAAK,GAAG,MAAM,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,WAAW,EAAE,CAAC;QAC3E,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QAC7B,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC;YACzB,IAAI,GAAG,GAAG,MAAM,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;YAC5E,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QACxB,CAAC;IACL,CAAC;IAED,qCAAqC;IACrC,0CAAU,GAAV;QACI,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC;IAChC,CAAC;IAED,sCAAsC;IACtC,2CAAW,GAAX,UAAY,MAAe;QACvB,iCAAiC;QACjC,IAAI,CAAC,eAAe,GAAG,KAAK,CAAC;IACjC,CAAC;IAvID;QAAC,mBAAY,CAAC,wDAAyB,CAAC;;4EAAA;IAzB5C;QAAC,gBAAS,CAAC;YACP,WAAW,EAAE,8EAA8E;YAC3F,UAAU,EAAE,CAAC,wDAAyB,EAAE,8BAAa,EAAE,8BAAa,EAAE,6CAAoB,EAAE,0BAAiB,CAAC;YAC9G,MAAM,EAAE,CAAC,4EAA4E,CAAC;SAEzF,CAAC;;6BAAA;IA8JF,4BAAC;AAAD,CA5JA,AA4JC,IAAA;AA5JY,6BAAqB,wBA4JjC,CAAA","file":"app/components/home/carReservations/reservations/reservations.component.js","sourcesContent":["import {Component, OnInit, AfterViewInit, ViewChildren, QueryList} from '@angular/core';\r\nimport {ActivatedRoute, ROUTER_DIRECTIVES} from '@angular/router';\r\nimport {CarService} from '../../../../services/car.service';\r\nimport {OfficeService} from '../../../../services/office.service';\r\nimport {UserService} from '../../../../services/user.service';\r\nimport {Office} from '../../../../models/office.admin.model';\r\nimport {User} from '../../../../models/user.admin.model';\r\nimport {TableReservationComponent} from './table/table.reservations.component';\r\nimport * as moment from 'moment';\r\nimport {TimeValidator, DateValidator} from \"../../../../validators/time.validator\";\r\nimport {OrderDetailComponent} from '../order/order.detail.component';\r\n\r\ndeclare var $: any;\r\n\r\n@Component({\r\n    templateUrl: 'app/components/home/carReservations/reservations/reservations.component.html',\r\n    directives: [TableReservationComponent, TimeValidator, DateValidator, OrderDetailComponent, ROUTER_DIRECTIVES],\r\n    styles: ['.table-arrow {top: 0px;} #filter{background-color: #f2f2f2; padding: 10px}']\r\n\r\n})\r\n\r\nexport class ReservationsComponent implements OnInit {\r\n    public reservationType: string = \"cars\";\r\n    public times = JSON.parse('[]');\r\n    public loggedUser: User = new User();\r\n    public data;\r\n    public usersList = [];\r\n    public length = 1;\r\n    public maxTime: number = 10.5;\r\n    public dateTime;\r\n    public week: number = 0;\r\n    public month: string;\r\n    public days;\r\n    public now = moment();\r\n    public moveDate = this.now.format(\"YYYY-MM-DD\");\r\n    public tableWidth;\r\n    public showOrderWindow: boolean = false;\r\n    public cars: Array<string> = new Array<string>();\r\n\r\n    @ViewChildren(TableReservationComponent) tableReservationComponent: QueryList<TableReservationComponent>;\r\n\r\n    constructor(private route: ActivatedRoute, private carService: CarService, private userService: UserService) { }\r\n\r\n    ngOnInit() {\r\n        this.loadUsersData();\r\n        this.updateTime();\r\n        this.updateWeek();\r\n\r\n        $(\"li.active\").removeClass(\"active\");\r\n        $(\"#liCars\").addClass(\"active\");\r\n\r\n\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        $(\"#content\").unbind(\"scroll\");\r\n    }\r\n\r\n    ngAfterViewInit() {\r\n        var tables = this.tableReservationComponent.toArray();\r\n        for (var i = 0; i < tables.length; i++) {\r\n            tables[i].updateData(this.week);\r\n        }\r\n    }\r\n\r\n    ngAfterContentInit() {\r\n        this.tableWidth = document.getElementById(\"reservationTable\").clientWidth;\r\n\r\n        $(window).on(\"resize\", function () {\r\n            this.tableWidth = document.getElementById(\"reservationTable\").clientWidth;\r\n            $(\"thead, #month\").css({ \"width\": this.tableWidth });\r\n        });\r\n\r\n        $(\"#content\").scroll(function () {\r\n            var element = $(\"thead\");\r\n            var headHeight = document.getElementById(\"header\").clientHeight;\r\n            if (!element.hasClass(\"headFixed\") && element.offset().top <= headHeight) {\r\n                element.addClass(\"headFixed\").css({ \"top\": headHeight });\r\n                $(\"#contentHolder\").show(0).css({ \"height\": element.height() });\r\n            }\r\n            if (element.hasClass(\"headFixed\") && $(\"tbody h4\").offset().top - element.height() > element.offset().top) {\r\n                element.removeClass(\"headFixed\");\r\n                $(\"#contentHolder\").hide(0).css({ \"height\": '0px' });\r\n            }\r\n        });\r\n    }\r\n\r\n    updateMaxTime() {\r\n        this.maxTime = (18 - moment(this.dateTime).hour()) * 60;\r\n    }\r\n\r\n    loadUsersData() {\r\n        this.userService.getUsers().subscribe(\r\n            data => {\r\n                var usersArray = data.json();\r\n                for (var i = 0; i < usersArray.length; i++)\r\n                    this.usersList[usersArray[i].id] = usersArray[i].name + ' ' + usersArray[i].surname;\r\n            },\r\n            error => console.log(error),\r\n            () => { this.loadCarsData() }\r\n        );\r\n        this.userService.myProfile().subscribe(\r\n            data => {\r\n                this.loggedUser = data.json();\r\n            },\r\n            error => console.log(error)\r\n        );\r\n    }\r\n\r\n\r\n    loadCarsData() {\r\n        this.carService.getCars().subscribe(\r\n            data => {\r\n                this.data = data.json();\r\n                for (var i = 0; i < this.data.length; i++) {\r\n                    var row = this.data[i];\r\n                    if (this.cars.indexOf(row.name) == -1)\r\n                        this.cars.push(row.name);\r\n                }\r\n            },\r\n            error => console.log(error)\r\n        );\r\n    }\r\n\r\n    updateTime() {\r\n        for (var i = 7; i < 19; i++) {\r\n            var time = moment().hour(i).minute(0).format('HH:mm');\r\n            this.times.push({ 'time': time });\r\n        }\r\n    }\r\n\r\n    moveFor() {\r\n        this.week += 1;\r\n        this.updateWeek();\r\n        this.ngAfterViewInit();\r\n    }\r\n\r\n    moveBack() {\r\n        this.week -= 1;\r\n        this.updateWeek();\r\n        this.ngAfterViewInit();\r\n    }\r\n\r\n    moveToday() {\r\n        this.week = 0;\r\n        this.updateWeek();\r\n        this.ngAfterViewInit();\r\n    }\r\n\r\n    moveToDate() {\r\n        this.week = moment(this.moveDate).week() - moment().week() + 52 * (moment(this.moveDate).year() - moment().year());\r\n        if (moment(this.moveDate).year() - moment().year() !== 0) this.week++;\r\n        this.updateWeek();\r\n        this.ngAfterViewInit();\r\n    }\r\n\r\n    updateWeek() {\r\n        this.month = moment().add(this.week, 'weeks').format(\"MMMM\").toUpperCase();\r\n        this.days = JSON.parse('[]');\r\n        for (var i = 1; i < 6; i++) {\r\n            var day = moment().add(this.week, 'weeks').weekday(i).format(\"dd DD.MM.YY\");\r\n            this.days.push(day);\r\n        }\r\n    }\r\n\r\n    //opens order.detail.component window\r\n    windowOpen() {\r\n        this.showOrderWindow = true;\r\n    }\r\n\r\n    //closes order.detail.component window\r\n    windowClose(action: boolean) {\r\n        // this.showOrderWindow = action;\r\n        this.showOrderWindow = false;\r\n    }\r\n\r\n\r\n}\r\n\r\n"],"sourceRoot":"/source/"}